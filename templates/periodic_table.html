<!-- templates/periodic_table.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Periodic Table</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --cell-size: 64px;
      --gap: 6px;

      /* Soft category palette */
      --s:#e8f3ff;  --p:#fff4e6;  --d:#f1f7ee;  --f:#f7ecff;
      --s-b:#2b7de9; --p-b:#d97706; --d-b:#3b7a2a; --f-b:#7e22ce;

      --card:#ffffff; --bg:#0b1220; --ink:#0b1220; --muted:#5e6b85;
      --panel:#f5f7fb;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--ink); background:#f3f6fb;
    }
    header{
      background:#1065ff; color:#fff; padding:22px 20px;
      box-shadow:0 6px 24px rgba(16,101,255,.25);
    }
    header h1{margin:0; font-size:1.6rem}
    main{max-width:1200px; margin:24px auto; padding:0 16px}
    .toolbar{
      display:flex; align-items:center; gap:8px; margin-bottom:14px; flex-wrap:wrap;
    }
    .legend{display:flex; gap:10px; flex-wrap:wrap}
    .tag{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:#fff; box-shadow:0 1px 2px rgba(12,15,20,.06)}
    .dot{width:12px; height:12px; border-radius:50%}
    .s  .dot{background:var(--s-b)}
    .p  .dot{background:var(--p-b)}
    .d  .dot{background:var(--d-b)}
    .f  .dot{background:var(--f-b)}

    .ptable{
      display:grid;
      grid-template-columns: repeat(18, minmax(var(--cell-size), 1fr));
      grid-auto-rows: var(--cell-size);
      gap: var(--gap);
      background:var(--panel);
      padding:12px;
      border-radius:14px;
      box-shadow:0 4px 14px rgba(12,15,20,.05) inset;
    }
    .cell{
      background:var(--card);
      border-radius:10px;
      display:flex; flex-direction:column; align-items:flex-start; justify-content:flex-end;
      padding:6px; position:relative; overflow:hidden;
      box-shadow:0 1px 2px rgba(12,15,20,.05);
      transition:transform .12s ease, box-shadow .12s ease;
      cursor:pointer;
      user-select:none;
    }
    .cell:hover{ transform:translateY(-2px); box-shadow:0 6px 16px rgba(12,15,20,.10)}
    .cell .num{position:absolute; top:6px; left:6px; font-size:.68rem; color:var(--muted)}
    .cell .sym{font-size:1.1rem; font-weight:800; line-height:1}
    .cell .name{font-size:.7rem; color:var(--muted); line-height:1.1}
    /* Category tints */
    .cell.s { outline:2px solid var(--s-b); background:var(--s) }
    .cell.p { outline:2px solid var(--p-b); background:var(--p) }
    .cell.d { outline:2px solid var(--d-b); background:var(--d) }
    .cell.f { outline:2px solid var(--f-b); background:var(--f) }

    /* Labels for lan/act rows */
    .row-label{
      display:flex; align-items:center; justify-content:center;
      font-size:.75rem; color:#fff; background:#334155; border-radius:8px;
    }

    /* Info panel */
    .info{
      margin-top:14px; background:#fff; border-radius:12px; padding:14px;
      box-shadow:0 2px 10px rgba(12,15,20,.06)
    }
    .info h2{margin:0 0 6px; font-size:1.1rem}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
<header>
  <h1>Interactive Periodic Table</h1>
</header>

<main>
  <div class="toolbar">
    <div class="legend">
      <span class="tag s"><span class="dot"></span> s-block</span>
      <span class="tag p"><span class="dot"></span> p-block</span>
      <span class="tag d"><span class="dot"></span> d-block</span>
      <span class="tag f"><span class="dot"></span> f-block</span>
    </div>
  </div>

  <div id="grid" class="ptable"></div>

  <div id="details" class="info muted">Tip: hover or tap an element to see details here.</div>
</main>

<script>
(async function(){
  const grid = document.getElementById('grid');
  const details = document.getElementById('details');
  const res = await fetch('/api/elements');
  const elems = await res.json();

  // Add empty placeholders so the grid has 9 rows x 18 cols
  grid.style.gridTemplateRows = 'repeat(9, var(--cell-size))';

  // Labels for lanthanide/actinide rows
  function addRowLabel(text, row){
    const el = document.createElement('div');
    el.className = 'row-label';
    el.style.gridRow = row;
    el.style.gridColumn = '1 / span 3';
    el.textContent = text;
    grid.appendChild(el);
  }
  addRowLabel('Lanthanides', 8);
  addRowLabel('Actinides', 9);

  const blockClass = (b) => (b && ['s','p','d','f'].includes(b)) ? b : '';

  elems.forEach(e=>{
    if (!e.row || !e.col) return;   // safety
    const cell = document.createElement('div');
    cell.className = `cell ${blockClass(e.block)}`;
    cell.style.gridRow = e.row;
    cell.style.gridColumn = e.col;
    cell.innerHTML = `
      <div class="num">${e.Z}</div>
      <div class="sym">${e.symbol}</div>
      <div class="name">${e.name}</div>
    `;
    cell.title = `${e.name} (${e.symbol}) — Z=${e.Z}`;
    cell.addEventListener('mouseenter', ()=> show(e));
    cell.addEventListener('click', ()=> show(e, true));
    grid.appendChild(cell);
  });

  function show(e, elevate){
    details.classList.remove('muted');
    details.innerHTML = `
      <h2>${e.name} (${e.symbol})</h2>
      <div>Atomic number: <b>${e.Z}</b></div>
      <div>Block: <b>${(e.block||'–').toUpperCase()}</b> &nbsp; Period: <b>${e.period||'–'}</b> &nbsp; Group: <b>${e.group||'–'}</b></div>
      <div>Approx. atomic mass: <b>${e.atomic_mass ? e.atomic_mass.toFixed(3) : '–'}</b></div>
      <p class="muted" style="margin:.6rem 0 0">Tip: click an element to keep this panel fixed.</p>
    `;
    if (elevate){
      details.scrollIntoView({behavior:'smooth', block:'nearest'});
    }
  }
})();
</script>
</body>
</html>
